---
import { Image } from 'astro:assets'
import testimonials from '../../data/json-files/testimonialsData.json'
import Col from './Col.astro'
import Section from './Section.astro'
import 'swiper/css/bundle'
---

<Section id="testimonials">
	<Col span="4">
		<div class="flex flex-wrap justify-center">
			<div class="w-full px-4">
				<div class="mx-auto mb-10 text-center">
					<h2>Opiniones de <strong>Clientes Satisfechos</strong></h2>
					<p>
						Descubre lo que dicen nuestros clientes sobre nuestros servicios. Nos enorgullece
						ofrecer experiencias excepcionales.
					</p>
				</div>
			</div>
		</div>

		<div class="-m-5">
			<div class="swiper testimonial-carousel common-carousel p-5">
				<div class="swiper-wrapper">
					{
						testimonials.map((testimonial) => (
							<div class="swiper-slide px-6">
								<div class="py-[30px] sm:px-[30px]" data-wow-delay=".1s">
									<div class="mb-[18px] flex items-center gap-[2px]">
										{[...Array(5)].map(() => (
											<span class="text-[#FBB040]">
												<svg
													class="fill-current"
													width="18"
													height="16"
													viewBox="0 0 18 16"
													fill="none"
													xmlns="http://www.w3.org/2000/svg"
												>
													<path d="M8.94043 0.360474L10.9477 6.06481H17.4433L12.1882 9.59028L14.1955 15.2946L8.94043 11.7691L3.68538 15.2946L5.69263 9.59028L0.437576 6.06481H6.93318L8.94043 0.360474Z" />
												</svg>
											</span>
										))}
									</div>
									<p>{testimonial.message}</p>

									<div class="flex items-center gap-4">
										<Image
											src={testimonial.image}
											alt="avatar"
											format="webp"
											class="rounded-full"
											width={50}
											height={50}
										/>
										<div>
											<span class="text-sm font-semibold dark:text-white">
												{testimonial.authorName}
											</span>
											<p class="text-body-secondary text-xs">{testimonial.authorRole}</p>
										</div>
									</div>
								</div>
							</div>
						))
					}
				</div>

				<div class="swiper-button-prev"></div>
				<div class="swiper-button-next"></div>
			</div>
		</div>
	</Col>
</Section>

<style>
	.swiper-button-prev,
	.swiper-button-next {
		height: 60px;
		width: auto;
		color: grey;
		margin-top: 3px;
	}
	.swiper-button-prev::after,
	.swiper-button-next::after {
		font-size: 20px;
		line-height: 60px;
	}
</style>

<script>
	import Swiper from 'swiper'
	import { Navigation } from 'swiper/modules'
	const testimonialSwiper = new Swiper('.testimonial-carousel', {
		modules: [Navigation],

		slidesPerView: 1,
		spaceBetween: 30,

		// Navigation arrows
		navigation: {
			nextEl: '.swiper-button-next',
			prevEl: '.swiper-button-prev'
		},

		breakpoints: {
			640: {
				slidesPerView: 1,
				spaceBetween: 30
			},
			1024: {
				slidesPerView: 2,
				spaceBetween: 30
			},
			1280: {
				slidesPerView: 3,
				spaceBetween: 30
			}
		}
	})
</script>
